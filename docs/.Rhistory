att_outcome <- df_s3b_employees_elg %>%
filter(!is.na(is_dom)) %>%
group_by(is_dom) %>%
summarise(N = n(),
attitude = mean(attitude,na.rm = T),
rec = mean(rec,na.rm = T),
points = mean(points,na.rm = T)) %>%
ungroup() %>%
filter(is_dom == 1) %>%
select(attitude) %>%
unlist() %>%
unname()
rec_outcome <- df_s3b_employees_elg %>%
filter(!is.na(is_dom)) %>%
group_by(is_dom) %>%
summarise(N = n(),
attitude = mean(attitude,na.rm = T),
rec = mean(rec,na.rm = T),
points = mean(points,na.rm = T)) %>%
ungroup() %>%
filter(is_dom == 1) %>%
select(rec) %>%
unlist() %>%
unname()
nrow(df_s3b_employees_elg)
nrow(df_s3b_employees_elg %>% filter(is_dom == 1))
mean_points <- df_s3b_employees_elg %>%
filter(is_dom == 1) %>%
summarise(mean = mean(points,na.rm = T)) %>%
pull()
df_s3b_employees_elg %>%
filter(is_dom == 1) %>%
ggplot(aes(x = points)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 5) +
scale_x_continuous(breaks = seq(0,50,5),
limits = c(-5,55)) +
ylab("count") +
geom_vline(xintercept = mean_points,
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
mean_att <- df_s3b_employees_elg %>%
filter(is_dom == 1) %>%
summarise(mean = mean(attitude,na.rm = T)) %>%
pull()
df_s3b_employees_elg %>%
filter(is_dom == 1) %>%
ggplot(aes(x = attitude)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 1) +
scale_x_continuous(breaks = seq(1,7,1),
limits = c(0,8)) +
ylab("count") +
geom_vline(xintercept = mean_att,
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
mean_rec <- df_s3b_employees_elg %>%
filter(is_dom == 1) %>%
summarise(mean = mean(rec,na.rm = T)) %>%
pull()
df_s3b_employees_elg %>%
filter(is_dom == 1) %>%
ggplot(aes(x = rec)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 1) +
scale_x_continuous(breaks = seq(0,1,1),
limits = c(-1,2)) +
ylab("count") +
geom_vline(xintercept = mean_rec,
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
nrow(df_s3b_employees_elg %>% filter(is_dom == 0))
mean_points <- df_s3b_employees_elg %>%
filter(is_dom == 0) %>%
summarise(mean = mean(points,na.rm = T)) %>%
pull()
df_s3b_employees_elg %>%
filter(is_dom == 0) %>%
ggplot(aes(x = points)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 5) +
scale_x_continuous(breaks = seq(0,50,5),
limits = c(-5,55)) +
ylab("count") +
geom_vline(xintercept = mean_points,
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
mean_att <- df_s3b_employees_elg %>%
filter(is_dom == 0) %>%
summarise(mean = mean(attitude,na.rm = T)) %>%
pull()
df_s3b_employees_elg %>%
filter(is_dom == 0) %>%
ggplot(aes(x = attitude)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 1) +
scale_x_continuous(breaks = seq(1,7,1),
limits = c(0,8)) +
ylab("count") +
geom_vline(xintercept = mean_att,
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
mean_rec <- df_s3b_employees_elg %>%
filter(is_dom == 0) %>%
summarise(mean = mean(rec,na.rm = T)) %>%
pull()
df_s3b_employees_elg %>%
filter(is_dom == 0) %>%
ggplot(aes(x = rec)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 1) +
scale_x_continuous(breaks = seq(0,1,1),
limits = c(-1,2)) +
ylab("count") +
geom_vline(xintercept = mean_rec,
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
df_forJNI <- df_s3b_managers_elg %>%
select(PID,CWV,attitude_dom) %>%
mutate(truth = att_outcome) %>%
rename(pred = attitude_dom) %>%
pivot_longer(-c(PID,CWV),
names_to = "type",
values_to = "score") %>%
mutate(is_outcome = ifelse(type == "truth",1,0))
fiti <- lm(score ~ CWV * is_outcome,data = df_forJNI)
interact_plot(fiti,
pred = "is_outcome",
modx = "CWV",
interval = T)
sim_slopes <- sim_slopes(fiti,
pred = "is_outcome",
modx = "CWV",
johnson_neyman = F)
sim_slopes$slopes
sim_slopes$ints
jn <- sim_slopes(
fiti,
pred = "is_outcome",
modx = "CWV",
johnson_neyman = TRUE,
control.fdr = TRUE,
# correction for type I and II
# include conditional intercepts
# conf.int = TRUE,
robust = "HC3",
# rubust SE
# don't mean-centered non-focal variables
# centered = "none",
jnalpha = 0.05
)
jn$jn
plot <- johnson_neyman(fiti,
pred = "is_outcome",
modx = "CWV",
control.fdr = T,
alpha = 0.05)
plot$plot
df_forJNI <- df_s3b_managers_elg %>%
select(PID,CWV,nompred_dom) %>%
mutate(truth = rec_outcome) %>%
rename(pred = nompred_dom) %>%
pivot_longer(-c(PID,CWV),
names_to = "type",
values_to = "score") %>%
mutate(is_outcome = ifelse(type == "truth",1,0))
fiti <- lm(score ~ CWV * is_outcome,data = df_forJNI)
interact_plot(fiti,
pred = "is_outcome",
modx = "CWV",
interval = T)
sim_slopes <- sim_slopes(fiti,
pred = "is_outcome",
modx = "CWV",
johnson_neyman = F)
sim_slopes$slopes
sim_slopes$ints
jn <- sim_slopes(
fiti,
pred = "is_outcome",
modx = "CWV",
johnson_neyman = TRUE,
control.fdr = TRUE,
# correction for type I and II
# include conditional intercepts
# conf.int = TRUE,
robust = "HC3",
# rubust SE
# don't mean-centered non-focal variables
# centered = "none",
jnalpha = 0.05
)
jn$jn
plot <- johnson_neyman(fiti,
pred = "is_outcome",
modx = "CWV",
control.fdr = T,
alpha = 0.05)
plot$plot
total_n <- df_s4 %>%
nrow()
detachAllPackages <- function() {
basic.packages <- c("package:stats","package:graphics","package:grDevices","package:utils","package:datasets","package:methods","package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:",search()))==1,TRUE,FALSE)]
package.list <- setdiff(package.list,basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package, character.only=TRUE)
}
detachAllPackages()
library(psych)
library(mediation)
library(interactions)
library(papaja)
library(kableExtra)
library(effectsize)
library(lavaan)
library(lme4)
library(tidyverse)
repo_url <- "https://raw.githubusercontent.com/deanbaltiansky/dominance-in-the-competitive-jungle/main/study-4/data/"
df_s4 <- readr::read_csv(paste0(repo_url,"df_s4.csv"), show_col_types = FALSE)
set.seed(20240914)
df_s4 <- df_s4  %>%
mutate(income = factor(income,c("$0-$20,000",
"$20,001-$40,000",
"$40,001-$60,000",
"$60,001-$80,000",
"$80,001-$100,000",
"$100,001-$120,000",
"$120,001-$140,000",
"$140,001-$160,000",
"$160,001-$180,000",
"$180,001-$200,000",
"Over $200,000")),
edu = factor(edu,c("noHS",
"GED",
"2yearColl",
"4yearColl",
"MA",
"PHD")),
income_num = as.numeric(income),
edu_num = as.numeric(edu),
man = ifelse(gender == "man",1,0),
cond_num = ifelse(cond == "pos",1,0))
total_n <- df_s4 %>%
nrow()
df_s4 %>%
group_by(att_1,att_2) %>%
summarise(N = n()) %>%
arrange(desc(N)) %>%
ungroup()
df_s4_elg <- df_s4 %>%
filter(elg == 1)
df_s4
df_s4_elg <- df_s4 %>%
filter(is_elg == 1)
eligible_n = df_s4_elg %>%
nrow()
df_s4 %>%
group_by(att_1,att_2) %>%
summarise(N = n()) %>%
arrange(desc(N)) %>%
ungroup() %>%
kbl()
df_s4 %>%
group_by(att_1,att_2) %>%
summarise(N = n()) %>%
arrange(desc(N)) %>%
ungroup()
df_s4_elg %>%
filter(cond == "pos") %>%
select(reflection)
## Negative Condition
```{r,echo=TRUE,results='asis',warning=FALSE}
df_s4_elg %>%
filter(cond == "neg") %>%
select(reflection)
df_s4_elg %>%
group_by(message_choice) %>%
summarise(N = n()) %>%
ungroup() %>%
mutate(Perc = round(100*(N/sum(N)),2)) %>%
ungroup() %>%
arrange(desc(Perc))
df_s4_elg %>%
ggplot(aes(x = attitude_dom)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 1) +
scale_x_continuous(breaks = seq(1,7,1),
limits = c(0,8)) +
ylab("count") +
geom_vline(xintercept = mean(df_s4_elg$attitude_dom,na.rm = T),
color = "black",
linetype = "dashed",
size = 1.1)
df_s4_elg %>%
ggplot(aes(x = attitude_dom)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 1) +
scale_x_continuous(breaks = seq(1,7,1),
limits = c(0,8)) +
ylab("count") +
geom_vline(xintercept = mean(df_s4_elg$attitude_dom,na.rm = T),
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
df_s4_elg %>%
ggplot(aes(x = pref_cont)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 1) +
scale_x_continuous(breaks = seq(1,6,1),
limits = c(0,7)) +
ylab("count") +
geom_vline(xintercept = mean(df_s4_elg$pref_cont,na.rm = T),
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
df_s4_elg %>%
ggplot(aes(x = pred_att)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 1) +
scale_x_continuous(breaks = seq(1,7,1),
limits = c(0,8)) +
ylab("count") +
geom_vline(xintercept = mean(df_s4_elg$pred_att,na.rm = T),
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
df_s4_elg %>%
ggplot(aes(x = pred_comp)) +
geom_histogram(fill = "lightblue",
color = NA,
binwidth = 5) +
scale_x_continuous(breaks = seq(0,50,5),
limits = c(-5,55)) +
ylab("count") +
geom_vline(xintercept = mean(df_s4_elg$pred_comp,na.rm = T),
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
alpha_score <- df_s4_elg %>%
dplyr::select(CWV_1:CWV_10R) %>%
psych::alpha()
df_s4_elg %>%
ggplot(aes(x = CWV)) +
geom_density(fill = "lightblue",
color = NA) +
scale_x_continuous(breaks = seq(1,7,1),
limits = c(1,7)) +
ylab("density") +
geom_vline(xintercept = mean(df_s4_elg$CWV,na.rm = T),
color = "black",
linetype = "dashed",
size = 1.1) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.line = element_line(color = "grey66"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black",
face = "bold"),
axis.title.x = element_text(color = "black",
face = "bold"))
df_s4_elg <- df_s4_elg %>%
mutate(cond = factor(cond,levels = c("pos","neg")))
rmarkdown::render("index.md")
<div style="margin-top: 0;">
rmarkdown::render("index.md", output_file = "index.html")
setwd("~/Google Drive/My Drive/dominance/portfolio-managerial-dominance/docs")
rmarkdown::render("index.md", output_file = "index.html")
rmarkdown::render("index.source.md", output_file = "index.html")
rmarkdown::render("index.source.md", output_file = "index.html")
rmarkdown::pandoc_convert(
"index.source.md",
to = "html",
output = "index.html",
options = c("--standalone", "--mathjax")
)
rmarkdown::pandoc_convert(
"index.source.md",
to = "html",
output = "index.html",
options = c("--standalone", "--mathjax))
rmarkdown::render("index.source.md", output_file = "index.html")
rmarkdown::render("index.source.md", output_file = "index.html")
rmarkdown::render("index.source.md", output_file = "index.html")
rmarkdown::render("index.source.md", output_file = "index.html")
rmarkdown::render("index.source.md", output_file = "index.html")
rmarkdown::render("index.source.md", output_file = "index.html")
rmarkdown::render("index.source.md", output_file = "index.html")
rmarkdown::render("index.source.md", output_file = "index.html")
rmarkdown::render("index.source.md", output_file = "index.html")
setwd("~/Google Drive/My Drive/american's dream/portfolio-social-contract/docs")
rmarkdown::render("index.md", output_file = "index.html")
setwd("~/Google Drive/My Drive/big picture/portfolio-three-sixty/docs")
rmarkdown::render("index.md")
rmarkdown::render("index.md")
